Warning: SetDeviceLostCallback is deprecated. Pass the callback in the device descriptor instead.
Warning: Old CreateRenderPipelineAsync APIs are deprecated. If using C please pass a CallbackInfo struct that has two userdatas. Otherwise, if using C++, please use templated helpers.
Warning: Old CreateComputePipelineAsync APIs are deprecated. If using C please pass a CallbackInfo struct that has two userdatas. Otherwise, if using C++, please use templated helpers.
Warning: Old MapAsync APIs are deprecated. If using C please pass a CallbackInfo struct that has two userdatas. Otherwise, if using C++, please use templated helpers.
=================================================================
==15657==ERROR: AddressSanitizer: heap-use-after-free on address 0x608000245348 at pc 0x7f956efd85be bp 0x7ffe1522d960 sp 0x7ffe1522d958
READ of size 8 at 0x608000245348 thread T0
    #0 0x7f956efd85bd in wgpu::interop::detail::PromiseBase::GetState() const /home/leu/Documents/projects/fyp/dawn/src/dawn/node/interop/Core.h:229:44
    #1 0x7f956efd165b in wgpu::binding::GPUDevice::GPUDevice(Napi::Env, wgpu::DeviceDescriptor const&, wgpu::Device, std::shared_ptr<wgpu::binding::AsyncRunner>)::$_2::operator()(WGPUDeviceLostReason, char const*, void*) const /home/leu/Documents/projects/fyp/dawn/src/dawn/node/binding/GPUDevice.cpp:193:37
    #2 0x7f956efd13c2 in wgpu::binding::GPUDevice::GPUDevice(Napi::Env, wgpu::DeviceDescriptor const&, wgpu::Device, std::shared_ptr<wgpu::binding::AsyncRunner>)::$_2::__invoke(WGPUDeviceLostReason, char const*, void*) /home/leu/Documents/projects/fyp/dawn/src/dawn/node/binding/GPUDevice.cpp:175:9
    #3 0x7f956f661ece in dawn::native::DeviceBase::DeviceLostEvent::Complete(dawn::EventCompletionType) /home/leu/Documents/projects/fyp/dawn/src/dawn/native/Device.cpp:248:9
    #4 0x7f956f7a8156 in dawn::native::EventManager::TrackedEvent::EnsureComplete(dawn::EventCompletionType) /home/leu/Documents/projects/fyp/dawn/src/dawn/native/EventManager.cpp:592:9
    #5 0x7f956f6613ad in dawn::native::DeviceBase::DeviceLostEvent::~DeviceLostEvent() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/Device.cpp:185:5
    #6 0x7f956f6613f8 in dawn::native::DeviceBase::DeviceLostEvent::~DeviceLostEvent() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/Device.cpp:184:49
    #7 0x7f9571f3b152 in dawn::RefCounted::DeleteThis() /home/leu/Documents/projects/fyp/dawn/src/dawn/common/RefCounted.cpp:158:5
    #8 0x7f9571f3b03e in dawn::RefCounted::Release() /home/leu/Documents/projects/fyp/dawn/src/dawn/common/RefCounted.cpp:147:9
    #9 0x7f956f51dd54 in dawn::detail::RefCountedTraits<dawn::native::EventManager::TrackedEvent>::Release(dawn::native::EventManager::TrackedEvent*) /home/leu/Documents/projects/fyp/dawn/src/dawn/common/Ref.h:50:44
    #10 0x7f956f51dd2f in dawn::RefBase<dawn::native::EventManager::TrackedEvent*, dawn::detail::RefCountedTraits<dawn::native::EventManager::TrackedEvent> >::Release(dawn::native::EventManager::TrackedEvent*) /home/leu/Documents/projects/fyp/dawn/src/dawn/common/RefBase.h:180:13
    #11 0x7f956f51dd09 in dawn::RefBase<dawn::native::EventManager::TrackedEvent*, dawn::detail::RefCountedTraits<dawn::native::EventManager::TrackedEvent> >::~RefBase() /home/leu/Documents/projects/fyp/dawn/src/dawn/common/RefBase.h:56:18
    #12 0x7f956f51b964 in dawn::Ref<dawn::native::EventManager::TrackedEvent>::~Ref() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/Forward.h:35:7
    #13 0x7f956f7bf058 in std::pair<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >::~pair() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/stl_iterator.h:2611:12
    #14 0x7f956f7bf038 in void std::__new_allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >::destroy<std::pair<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >(std::pair<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/new_allocator.h:181:10
    #15 0x7f956f7beffc in void std::allocator_traits<std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destroy<std::pair<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >(std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >&, std::pair<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/alloc_traits.h:535:8
    #16 0x7f956f7befcc in auto absl::container_internal::map_slot_policy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >::destroy<std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >(std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/container_memory.h:431:7
    #17 0x7f956f7bef9c in auto absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >::destroy<std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >(std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/flat_hash_map.h:590:12
    #18 0x7f956f7bef4c in auto absl::container_internal::common_policy_traits<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, void>::destroy<std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >(std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > >*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/common_policy_traits.h:51:12
    #19 0x7f956f7be394 in absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destroy(absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_set.h:3435:5
    #20 0x7f956f7be94e in absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destroy_slots()::'lambda'(absl::container_internal::ctrl_t const*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*)::operator()(absl::container_internal::ctrl_t const*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*) const /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_set.h:3487:50
    #21 0x7f956f7be94e in void absl::container_internal::IterateOverFullSlots<absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destroy_slots()::'lambda'(absl::container_internal::ctrl_t const*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*)>(absl::container_internal::CommonFields const&, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*, absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destroy_slots()::'lambda'(absl::container_internal::ctrl_t const*, absl::container_internal::map_slot_type<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >*)) /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_set.h:1871:7
    #22 0x7f956f7be94e in absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destroy_slots() /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_set.h:3484:5
    #23 0x7f956f7be271 in absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::destructor_impl() /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_set.h:3508:5
    #24 0x7f956f7be1e8 in absl::container_internal::raw_hash_set<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::~raw_hash_set() /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_set.h:2792:21
    #25 0x7f956f7be1c4 in absl::container_internal::raw_hash_map<absl::container_internal::FlatHashMapPolicy<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent> >, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::~raw_hash_map() /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/internal/raw_hash_map.h:33:7
    #26 0x7f956f7be1a4 in absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >::~flat_hash_map() /home/leu/Documents/projects/fyp/dawn/third_party/abseil-cpp/absl/container/flat_hash_map.h:124:7
    #27 0x7f956f7be17c in std::_Optional_payload_base<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > >::_M_destroy() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/optional:287:23
    #28 0x7f956f7be112 in std::_Optional_payload_base<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > >::_M_reset() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/optional:318:4
    #29 0x7f956f7be054 in std::_Optional_base_impl<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >, std::_Optional_base<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > >, false, false> >::_M_reset() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/optional:468:45
    #30 0x7f956f7bfab4 in std::optional<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > >::reset() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/optional:1170:58
    #31 0x7f956f7ac183 in auto dawn::native::EventManager::ShutDown()::$_1::operator()<dawn::detail::Guard<std::optional<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > >, dawn::detail::MutexProtectedTraits<std::optional<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > > > > >(dawn::detail::Guard<std::optional<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > >, dawn::detail::MutexProtectedTraits<std::optional<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > > > >) const /home/leu/Documents/projects/fyp/dawn/src/dawn/native/EventManager.cpp:340:46
    #32 0x7f956f7a7655 in auto dawn::MutexProtected<std::optional<absl::flat_hash_map<unsigned long, dawn::Ref<dawn::native::EventManager::TrackedEvent>, absl::hash_internal::Hash<unsigned long>, std::equal_to<unsigned long>, std::allocator<std::pair<unsigned long const, dawn::Ref<dawn::native::EventManager::TrackedEvent> > > > >, dawn::detail::Guard>::Use<dawn::native::EventManager::ShutDown()::$_1>(dawn::native::EventManager::ShutDown()::$_1&&) /home/leu/Documents/projects/fyp/dawn/src/dawn/common/MutexProtected.h:156:16
    #33 0x7f956f7a750d in dawn::native::EventManager::ShutDown() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/EventManager.cpp:340:13
    #34 0x7f956f824a0f in dawn::native::InstanceBase::WillDropLastExternalRef() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/Instance.cpp:200:19
    #35 0x7f956f4f7f2e in dawn::native::RefCountedWithExternalCountBase<dawn::RefCounted>::APIRelease() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/RefCountedWithExternalCount.h:58:13
    #36 0x7f956f4f6bd9 in dawn::native::Instance::~Instance() /home/leu/Documents/projects/fyp/dawn/src/dawn/native/DawnNative.cpp:186:16
    #37 0x7f956ef83fea in std::default_delete<dawn::native::Instance>::operator()(dawn::native::Instance*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:95:2
    #38 0x7f956ef837d0 in std::unique_ptr<dawn::native::Instance, std::default_delete<dawn::native::Instance> >::~unique_ptr() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:396:4
    #39 0x7f956ef836f9 in wgpu::binding::GPU::~GPU() /home/leu/Documents/projects/fyp/dawn/src/dawn/node/binding/GPU.h:43:7
    #40 0x7f956ef97878 in wgpu::binding::GPU::~GPU() /home/leu/Documents/projects/fyp/dawn/src/dawn/node/binding/GPU.h:43:7
    #41 0x7f956ef83566 in std::default_delete<wgpu::interop::GPU>::operator()(wgpu::interop::GPU*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:95:2
    #42 0x7f956ef822f0 in std::unique_ptr<wgpu::interop::GPU, std::default_delete<wgpu::interop::GPU> >::~unique_ptr() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:396:4
    #43 0x7f956f336e20 in wgpu::interop::(anonymous namespace)::Wrappers::WGPU::~WGPU() /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2822:10
    #44 0x7f956f336e48 in wgpu::interop::(anonymous namespace)::Wrappers::WGPU::~WGPU() /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2822:10
    #45 0x7f956f3371f5 in Napi::ObjectWrap<wgpu::interop::(anonymous namespace)::Wrappers::WGPU>::FinalizeCallback(napi_env__*, void*, void*) /home/leu/Documents/projects/fyp/dawn/third_party/node-addon-api/napi-inl.h:4885:3
    #46 0x556c562179fe in node_napi_env__::CallFinalizer(void (*)(napi_env__*, void*, void*), void*, void*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xa179fe) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #47 0x556c561f4fa5 in v8impl::TrackedFinalizer::FinalizeCore(bool) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9f4fa5) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #48 0x556c5621c69e in node_napi_env__::DeleteMe() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xa1c69e) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #49 0x556c561a38a9 in node::CleanupQueue::Drain() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9a38a9) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #50 0x556c561d0c13 in node::Environment::RunCleanup() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9d0c13) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #51 0x556c56171a36 in node::FreeEnvironment(node::Environment*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x971a36) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #52 0x556c562bcf67 in node::NodeMainInstance::Run() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xabcf67) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #53 0x556c56213dc4 in node::Start(int, char**) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xa13dc4) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #54 0x7f9579df5d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #55 0x7f9579df5e3f in __libc_start_main csu/../csu/libc-start.c:392:3
    #56 0x556c5616a7b4 in _start (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x96a7b4) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)

0x608000245348 is located 40 bytes inside of 88-byte region [0x608000245320,0x608000245378)
freed by thread T0 here:
    #0 0x7f957b2a122d in operator delete(void*) (/usr/lib/llvm-14/lib/clang/14.0.0/lib/linux/libclang_rt.asan-x86_64.so+0xdc22d) (BuildId: a6105a816e63299474c1078329a59ed80f244fbf)
    #1 0x7f956efc6061 in wgpu::binding::GPUDevice::~GPUDevice() /home/leu/Documents/projects/fyp/dawn/src/dawn/node/binding/GPUDevice.cpp:201:25
    #2 0x7f956efc4cf6 in std::default_delete<wgpu::interop::GPUDevice>::operator()(wgpu::interop::GPUDevice*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:95:2
    #3 0x7f956efb9c70 in std::unique_ptr<wgpu::interop::GPUDevice, std::default_delete<wgpu::interop::GPUDevice> >::~unique_ptr() /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:396:4
    #4 0x7f956f3152c0 in wgpu::interop::(anonymous namespace)::Wrappers::WGPUDevice::~WGPUDevice() /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2346:10
    #5 0x7f956f3152e8 in wgpu::interop::(anonymous namespace)::Wrappers::WGPUDevice::~WGPUDevice() /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2346:10
    #6 0x7f956f315695 in Napi::ObjectWrap<wgpu::interop::(anonymous namespace)::Wrappers::WGPUDevice>::FinalizeCallback(napi_env__*, void*, void*) /home/leu/Documents/projects/fyp/dawn/third_party/node-addon-api/napi-inl.h:4885:3
    #7 0x556c562179fe in node_napi_env__::CallFinalizer(void (*)(napi_env__*, void*, void*), void*, void*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xa179fe) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #8 0x556c561f4fa5 in v8impl::TrackedFinalizer::FinalizeCore(bool) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9f4fa5) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #9 0x556c5621c69e in node_napi_env__::DeleteMe() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xa1c69e) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #10 0x556c561a38a9 in node::CleanupQueue::Drain() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9a38a9) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #11 0x556c561d0c13 in node::Environment::RunCleanup() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9d0c13) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #12 0x556c56171a36 in node::FreeEnvironment(node::Environment*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x971a36) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #13 0x556c562bcf67 in node::NodeMainInstance::Run() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xabcf67) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #14 0x556c56213dc4 in node::Start(int, char**) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xa13dc4) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #15 0x7f9579df5d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16

previously allocated by thread T0 here:
    #0 0x7f957b2a09cd in operator new(unsigned long) (/usr/lib/llvm-14/lib/clang/14.0.0/lib/linux/libclang_rt.asan-x86_64.so+0xdb9cd) (BuildId: a6105a816e63299474c1078329a59ed80f244fbf)
    #1 0x7f956efb9729 in std::__detail::_MakeUniq<wgpu::binding::GPUDevice>::__single_object std::make_unique<wgpu::binding::GPUDevice, Napi::Env&, wgpu::DeviceDescriptor&, WGPUDeviceImpl*&, std::shared_ptr<wgpu::binding::AsyncRunner>&>(Napi::Env&, wgpu::DeviceDescriptor&, WGPUDeviceImpl*&, std::shared_ptr<wgpu::binding::AsyncRunner>&) /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/unique_ptr.h:1065:30
    #2 0x7f956efb660f in wgpu::binding::GPUAdapter::requestDevice(Napi::Env, wgpu::interop::GPUDeviceDescriptor) /home/leu/Documents/projects/fyp/dawn/src/dawn/node/binding/GPUAdapter.cpp:196:23
    #3 0x7f956f327013 in wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter::requestDeviceInner(Napi::CallbackInfo const&) /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2777:31
    #4 0x7f956f3268d1 in wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter::requestDevice(Napi::CallbackInfo const&)::'lambda'()::operator()() const /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2766:75
    #5 0x7f956f3263e6 in Napi::Value wgpu::interop::CatchExceptionIntoPromise<wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter::requestDevice(Napi::CallbackInfo const&)::'lambda'()>(Napi::Env, wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter::requestDevice(Napi::CallbackInfo const&)::'lambda'()&&) /home/leu/Documents/projects/fyp/dawn/src/dawn/node/interop/Core.h:814:26
    #6 0x7f956f31cc81 in wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter::requestDevice(Napi::CallbackInfo const&) /home/leu/Documents/projects/fyp/dawn/out/asan/gen/node/src/dawn/node/interop/WebGPU.cpp:2766:14
    #7 0x7f956f324e03 in Napi::InstanceWrap<wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter>::InstanceMethodCallbackWrapper(napi_env__*, napi_callback_info__*)::'lambda'()::operator()() const /home/leu/Documents/projects/fyp/dawn/third_party/node-addon-api/napi-inl.h:4375:23
    #8 0x7f956f3247ee in napi_value__* Napi::details::WrapCallback<Napi::InstanceWrap<wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter>::InstanceMethodCallbackWrapper(napi_env__*, napi_callback_info__*)::'lambda'()>(Napi::InstanceWrap<wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter>::InstanceMethodCallbackWrapper(napi_env__*, napi_callback_info__*)::'lambda'()) /home/leu/Documents/projects/fyp/dawn/third_party/node-addon-api/napi-inl.h:87:10
    #9 0x7f956f32397c in Napi::InstanceWrap<wgpu::interop::(anonymous namespace)::Wrappers::WGPUAdapter>::InstanceMethodCallbackWrapper(napi_env__*, napi_callback_info__*) /home/leu/Documents/projects/fyp/dawn/third_party/node-addon-api/napi-inl.h:4368:10
    #10 0x556c561f401c in v8impl::(anonymous namespace)::FunctionCallbackWrapper::Invoke(v8::FunctionCallbackInfo<v8::Value> const&) js_native_api_v8.cc
    #11 0x556bf6d4eadc in Builtins_CallApiCallbackGeneric embedded.o
    #12 0x556bf6d4cf17 in Builtins_InterpreterEntryTrampoline embedded.o
    #13 0x556bf6d89e42 in Builtins_AsyncFunctionAwaitResolveClosure embedded.o
    #14 0x556bf6e561b0 in Builtins_PromiseFulfillReactionJob embedded.o
    #15 0x556bf6d774e7 in Builtins_RunMicrotasks embedded.o
    #16 0x556bf6d4aa42 in Builtins_JSRunMicrotasksEntry embedded.o
    #17 0x556c565ca025 in v8::internal::(anonymous namespace)::Invoke(v8::internal::Isolate*, v8::internal::(anonymous namespace)::InvokeParams const&) execution.cc
    #18 0x556c565cae1f in v8::internal::(anonymous namespace)::InvokeWithTryCatch(v8::internal::Isolate*, v8::internal::(anonymous namespace)::InvokeParams const&) execution.cc
    #19 0x556c565cb0d7 in v8::internal::Execution::TryRunMicrotasks(v8::internal::Isolate*, v8::internal::MicrotaskQueue*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xdcb0d7) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #20 0x556c565f9a16 in v8::internal::MicrotaskQueue::RunMicrotasks(v8::internal::Isolate*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xdf9a16) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #21 0x556c565f9d82 in v8::internal::MicrotaskQueue::PerformCheckpointInternal(v8::Isolate*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0xdf9d82) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #22 0x556c5616c9a3 in node::InternalCallbackScope::Close() (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x96c9a3) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #23 0x556c5616cf13 in node::InternalMakeCallback(node::Environment*, v8::Local<v8::Object>, v8::Local<v8::Object>, v8::Local<v8::Function>, int, v8::Local<v8::Value>*, node::async_context) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x96cf13) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #24 0x556c5616d031 in node::MakeCallback(v8::Isolate*, v8::Local<v8::Object>, v8::Local<v8::Function>, int, v8::Local<v8::Value>*, node::async_context) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x96d031) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #25 0x556c561d07d1 in node::Environment::CheckImmediate(uv_check_s*) (/home/linuxbrew/.linuxbrew/Cellar/node/21.7.3/bin/node+0x9d07d1) (BuildId: 0d36d9e07656c1b6a4dd9a2b03ac478fb98b3e5f)
    #26 0x7f957b18aca8 in uv__run_check (/home/linuxbrew/.linuxbrew/opt/libuv/lib/libuv.so.1+0x18ca8) (BuildId: 8760571cc4e43701934035f25e7982586468c2ad)
    #27 0x7ffe1522ec2f  ([stack]+0x54c2f)

SUMMARY: AddressSanitizer: heap-use-after-free /home/leu/Documents/projects/fyp/dawn/src/dawn/node/interop/Core.h:229:44 in wgpu::interop::detail::PromiseBase::GetState() const
Shadow bytes around the buggy address:
  0x0c1080040a10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c1080040a20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c1080040a30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c1080040a40: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c1080040a50: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
=>0x0c1080040a60: fa fa fa fa fd fd fd fd fd[fd]fd fd fd fd fd fa
  0x0c1080040a70: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c1080040a80: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c1080040a90: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c1080040aa0: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c1080040ab0: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==15657==ABORTING
